---
title: "Logistic Regression"
author: "Amey Joshi"
format: html
editor: visual
---

## Ravens Data

```{r}
path <- './datasets/ravensData.rda'
load(path)

head(ravensData)
```

The variables of interest are `ravenWinNum`, `ravenScore` and `opponentScore`. Does it ever happen that the Raven team won when its score was less than or equal to its opponent?

```{r}
ravensData[(ravensData$ravenWinNum == 1) &
             (ravensData$ravenScore <= ravensData$opponentScore), ]
```

There are none and this should not be any surprise. If we know the scores of both the teams we can confidently tell who won. We are interested in building a model that predicts if Raven wins knowing its score alone.

## Logistic regression model

We use the function `glm` to fit a logistic regression model. The link function here is `logit` and the family of outcome is `binomial`.

```{r}
res <- with(ravensData, glm(ravenWinNum ~ ravenScore, family = 'binomial'))
summary(res)
```

We check how good the model is by plotting its prediction with the data.

```{r}
plot(
  ravensData$ravenScore,
  res$fitted.values,
  pch = 16,
  col = 'blue',
  xlab = 'Score',
  ylab = 'Probability of winning',
  main = 'Logistic regression'
)
```

The `echo: false` option disables the printing of code (only output is displayed).
